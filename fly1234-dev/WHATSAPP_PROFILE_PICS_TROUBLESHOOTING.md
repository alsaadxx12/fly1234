# ุงุณุชูุดุงู ุฃุฎุทุงุก ุตูุฑ ุงูููู ุงูุดุฎุตู ูู ูุงุชุณุงุจ

## ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

ููู ุชุนูู ููุฒุฉ ุฌูุจ ุตูุฑ ูุงุชุณุงุจุ ูุฌุจ:

1. **ุฅุถุงูุฉ ุญุณุงุจ ูุงุชุณุงุจ ูู ุงูุฅุนุฏุงุฏุงุช**
   - ุงุฐูุจ ุฅูู ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช (Settings)
   - ูุณู "ุฅุนุฏุงุฏุงุช ุงููุงุชุณุงุจ"
   - ุชุจููุจ "ุญุณุงุจุงุช ุงููุงุชุณุงุจ"
   - ุงุถุบุท ุนูู "ุฅุถุงูุฉ ุญุณุงุจ ุฌุฏูุฏ +"
   - ุฃุฏุฎู:
     - **ุงุณู ุงูุญุณุงุจ**: (ูุซู: alrawdatain control)
     - **Instance ID**: ูุนุฑู ุงููุณุฎุฉ ูู UltraMsg (ูุซุงู: 142767)
     - **Token**: ุฑูุฒ ุงููุตูู ูู UltraMsg
   - โ **ููู ุฌุฏุงู**: ูุนูู "ุงูุญุณุงุจ ุงููุดุท" ููุญุณุงุจ ุงูุฐู ุชุฑูุฏ ุงุณุชุฎุฏุงูู

2. **ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช**
   - ุงูุชุญ Console ูู ุงููุชุตูุญ (F12)
   - ุงุจุญุซ ุนู ุฑุณุงูุฉ: `WhatsApp accounts loaded: 1` (ุฃู ุฃูุซุฑ)
   - ุงุจุญุซ ุนู ุฑุณุงูุฉ: `Active WhatsApp account found: {name: "...", ...}`
   - ูุฌุจ ุฃู ุชุฑู ุงุณู ุงูุญุณุงุจ ุงููุดุท ูุชุฃููุฏ ูุฌูุฏ instanceId ู token

## ุฎุทูุงุช ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### 1. ุงูุชุญูู ูู ุชุญููู ุญุณุงุจุงุช ุงููุงุชุณุงุจ

ุงูุชุญ Console ูุงุจุญุซ ุนู:
```
Loading WhatsApp accounts for user: [user-id]
WhatsApp accounts loaded: 1
Active WhatsApp account found: { name: "alrawdatain control", instanceId: "142767", hasToken: true }
```

ุฅุฐุง ุฑุฃูุช:
- `WhatsApp accounts loaded: 0` โ ูู ูุชู ุฅุถุงูุฉ ุฃู ุญุณุงุจ
- `No active account, using first account` โ ูู ูุชู ุชูุนูู ุฃู ุญุณุงุจ (ุณูุณุชุฎุฏู ุงูุฃูู)
- `No WhatsApp accounts configured` โ ูุง ุชูุฌุฏ ุญุณุงุจุงุช

**ุงูุญู**: ุงุฐูุจ ุฅูู Settings โ ุฅุนุฏุงุฏุงุช ุงููุงุชุณุงุจ โ ุญุณุงุจุงุช ุงููุงุชุณุงุจ ูุฃุถู ุญุณุงุจุงู ุฌุฏูุฏุงู

### 2. ุงูุชุญูู ูู ุฌูุจ ุงูุฃุฑูุงู

ุนูุฏ ุชุญููู ุตูุญุฉ ุงูุนููุงุก APIุ ุงุจุญุซ ุนู:
```
Customers with valid phone numbers: 10
Phone numbers to fetch: ["9647714289278", ...]
Starting to prefetch profile pictures...
```

ุฅุฐุง ุฑุฃูุช:
- `Customers with valid phone numbers: 0` โ ูุง ุชูุฌุฏ ุฃุฑูุงู ุตุงูุญุฉ
- `No valid phone numbers found` โ ุฌููุน ุงูุฃุฑูุงู ุบูุฑ ูุฏุนููุฉ

**ุงูุญู**: ุชุฃูุฏ ูู ุฃู ุงูุฃุฑูุงู ุจุงูุตูุบุฉ ุงูุตุญูุญุฉ (07xxx ุฃู 9647xxx)

### 3. ุงูุชุญูู ูู ุทูุจุงุช API

ุงุจุญุซ ุนู:
```
Fetching WhatsApp profile picture for: 9647714289278 using account: alrawdatain control
Profile picture API response: {...}
Extracted profile URL: https://...
```

**ููุงุญุธุฉ**: ูุฌุจ ุฃู ุชุฑู ุงุณู ุงูุญุณุงุจ ุงููุณุชุฎุฏู ูู ุฑุณุงูุฉ "using account"

ุฅุฐุง ุฑุฃูุช ุฃุฎุทุงุก:
- `Error fetching profile picture` โ ูุดููุฉ ูู ุงูุงุชุตุงู ุจู API
- `timeout of 10000ms exceeded` โ ุจุทุก ูู ุงูุงุชุตุงู
- `403` โ ุฑูุฒ ุงููุตูู ุบูุฑ ุตุญูุญ
- `404` โ ูุนุฑู ุงููุณุฎุฉ ุบูุฑ ุตุญูุญ

### 4. ุฃุฎุทุงุก ุดุงุฆุนุฉ

#### ุงูุฎุทุฃ: "WhatsApp config incomplete"
**ุงูุณุจุจ**: Instance ID ุฃู Token ูุงุฑุบ
**ุงูุญู**: ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช ูู ุตูุญุฉ Settings

#### ุงูุฎุทุฃ: "Error fetching profile picture: 403"
**ุงูุณุจุจ**: ุฑูุฒ ุงููุตูู (Token) ุบูุฑ ุตุญูุญ ุฃู ููุชูู ุงูุตูุงุญูุฉ
**ุงูุญู**:
1. ุงุฐูุจ ุฅูู ููุญุฉ ุชุญูู UltraMsg
2. ุงุญุตู ุนูู Token ุฌุฏูุฏ
3. ุญุฏูุซ ูู Settings

#### ุงูุฎุทุฃ: "Error fetching profile picture: 404"
**ุงูุณุจุจ**: Instance ID ุบูุฑ ุตุญูุญ
**ุงูุญู**:
1. ุชุญูู ูู Instance ID ูู UltraMsg
2. ูุฌุจ ุฃู ูููู ุฃุฑูุงู ููุท (ูุซุงู: 123456)
3. ุญุฏูุซ ูู Settings

#### ูุง ุชูุฌุฏ ุตูุฑ ููุง ุฃุฎุทุงุก
**ุงูุณุจุจ**: ุงูุฃุฑูุงู ููุณ ููุง ุญุณุงุจุงุช ูุงุชุณุงุจ ุฃู ุงูุตูุฑ ุฎุงุตุฉ
**ููุงุญุธุฉ**: ุจุนุถ ุงููุณุชุฎุฏููู ูุฎููู ุตูุฑ ูููุงุชูู ุงูุดุฎุตูุฉ

## ููููุฉ ุงูุชุญูู ูู ุนูู ุงูููุฒุฉ

1. ุงูุชุญ ุตูุญุฉ ุนููุงุก API
2. ุณุฌูู ุงูุฏุฎูู ุจุญุณุงุจ API
3. ุงูุธุฑ ุฅูู ุฃููููุงุช ุงูุนููุงุก:
   - โ ุตูุฑุฉ ุญููููุฉ โ ุชู ุฌูุจูุง ูู ูุงุชุณุงุจ
   - ๐ Spinner โ ุฌุงุฑู ุงูุชุญููู
   - ๐จ ุฃููููุฉ ููููุฉ ุจุงูุฃุญุฑู ุงูุฃููู โ ูุง ุชูุฌุฏ ุตูุฑุฉ ุฃู ูุดู ุงูุชุญููู

## Cache ุงูุตูุฑ

- ุงูุตูุฑ ุชูุญูุธ ููุฏุฉ 24 ุณุงุนุฉ
- ูุฅุนุงุฏุฉ ุฌูุจ ุงูุตูุฑุ ุงูุชุธุฑ 24 ุณุงุนุฉ ุฃู ุงูุณุญ cache ุงููุชุตูุญ
- Cache ูุณุงุนุฏ ูู ุชุญุณูู ุงูุฃุฏุงุก ูุชูููู ุงุณุชููุงู API

## API Endpoint ุงููุณุชุฎุฏู

```
POST https://api.ultramsg.com/instance{instanceId}/contacts/profile-pic
Body: token={token}&chatId={phone}@c.us
```

## ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ:
1. ุชุญูู ูู ุฃู ุญุณุงุจ UltraMsg ูุดุท
2. ุชุญูู ูู ุฃู ูุฏูู ุฑุตูุฏ ูุงูู
3. ุชุญูู ูู ุญุงูุฉ ุงูุฎุฏูุฉ ุนูู ูููุน UltraMsg
