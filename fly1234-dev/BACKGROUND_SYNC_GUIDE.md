# ุฏููู ุงููุฒุงููุฉ ุงูุนุงูููุฉ ูู ุงูุฎูููุฉ
## Global Background Sync Guide

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุฒุงููุฉ ุนุงููู ูุนูู ูู ุงูุฎูููุฉ ูุชุญุฏูุซ ุฃุฑุตุฏุฉ ุฎุทูุท ุงูุทูุฑุงู ุชููุงุฆูุงู ูู APIs ุงูุฎุงุตุฉ ุจูุง.

## โจ ุงููููุฒุงุช

### 1. **ุงููุฒุงููุฉ ูู ุงูุฎูููุฉ**
- ุชุนูู ุงููุฒุงููุฉ ุชููุงุฆูุงู ูู ุงูุฎูููุฉ ุทูุงู ูุชุฑุฉ ุชุดุบูู ุงูุชุทุจูู
- ูุง ุชุชุทูุจ ุจูุงุก ุงููุณุชุฎุฏู ูู ุตูุญุฉ ูุนููุฉ
- ุชุณุชูุฑ ูู ุงูุนูู ุฃุซูุงุก ุงูุชููู ุจูู ุงูุตูุญุงุช

### 2. **ุงูุชุญูู ุงููุงูู**
- ุชูุนูู/ุชุนุทูู ุงููุฒุงููุฉ ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู
- ุชุญุฏูุฏ ูุชุฑุฉ ุงููุฒุงููุฉ (ุจุงูุซูุงูู)
- ูุฒุงููุฉ ูุฏููุฉ ููุฑูุฉ ุนูุฏ ุงูุญุงุฌุฉ

### 3. **ุงููุชุงุจุนุฉ ุงูููุฑูุฉ**
- ุนุฑุถ ุญุงูุฉ ุงููุฒุงููุฉ (ูุดุทุฉ/ูุชูููุฉ)
- ุฅุธูุงุฑ ุงูุงุชุตุงูุงุช ุงูุชู ูุชู ูุฒุงููุชูุง ุญุงููุงู
- ุนุฑุถ ุนุฏุฏ ุงููุฒุงููุงุช ุงููุงุฌุญุฉ ูุงููุงุดูุฉ
- ุนุฑุถ ููุช ุขุฎุฑ ูุฒุงููุฉ

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### ุงููููุงุช ุงูุฑุฆูุณูุฉ:

1. **`src/components/GlobalApiSync.tsx`**
   - ูููู React ูุนูู ูู ุงูุฎูููุฉ
   - ูุชู ุชุญูููู ูุฑุฉ ูุงุญุฏุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู
   - ูุจูู ูุดุทุงู ุทูุงู ูุชุฑุฉ ุชุดุบูู ุงูุชุทุจูู

2. **`src/lib/services/apiSyncService.ts`**
   - ุงูุฎุฏูุฉ ุงูุฑุฆูุณูุฉ ูููุฒุงููุฉ
   - ุชุญุชูู ุนูู ูู ููุทู ุงููุฒุงููุฉ
   - ุชุณุชุฎุฏู Firestore Snapshots ููุชุญุฏูุซุงุช ุงูููุฑูุฉ

3. **`src/App.tsx`**
   - ูุชู ุชุญููู ูููู GlobalApiSync ุนูู ูุณุชูู ุงูุชุทุจูู
   - ูุถูู ุงุณุชูุฑุงุฑ ุนูู ุงููุฒุงููุฉ ูู ุฌููุน ุงูุตูุญุงุช

### ููููุฉ ุงูุนูู:

```
App.tsx
  โโ> GlobalApiSync Component (ูุนูู ูู ุงูุฎูููุฉ)
       โโ> apiSyncService (ุฎุฏูุฉ ุงููุฒุงููุฉ)
            โโ> Firestore Snapshot (ูุฑุงูุจุฉ ุงูุชุบููุฑุงุช)
            โโ> setInterval (ุฌุฏููุฉ ุงููุฒุงููุงุช)
            โโ> API Calls (ุชุญุฏูุซ ุงูุฃุฑุตุฏุฉ)
```

## ๐ฏ ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู

### ูู ุตูุญุฉ ุฑุจุท API:

1. **ุชูุนูู ุงููุฒุงููุฉ ุงูุนุงูููุฉ:**
   - ุงูุชุญ ุตูุญุฉ "ุฑุจุท API ุฎุทูุท ุงูุทูุฑุงู"
   - ุงุจุญุซ ุนู ูุณู "ุงููุฒุงููุฉ ุงูุนุงูููุฉ"
   - ูู ุจุชูุนูู ุงูููุชุงุญ (toggle)

2. **ุชุญุฏูุฏ ูุชุฑุฉ ุงููุฒุงููุฉ:**
   - ุฃุฏุฎู ุงููุฏุฉ ุงูุฒูููุฉ ุจุงูุซูุงูู (10-300)
   - ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: 30 ุซุงููุฉ
   - ูุชู ุชุทุจูู ุงูุชุบููุฑ ููุฑุงู

3. **ุงููุฒุงููุฉ ุงููุฏููุฉ:**
   - ุงุถุบุท ุนูู ุฒุฑ "ูุฒุงููุฉ ุงูุขู"
   - ุณูุชู ุชุญุฏูุซ ุฌููุน ุงูุงุชุตุงูุงุช ุงููุดุทุฉ ููุฑุงู

### ุงููุชุทูุจุงุช:

- ูุฌุจ ุฃู ูููู ูุฏูู ุงุชุตุงู ูุงุญุฏ ูุดุท ุนูู ุงูุฃูู
- ูุฌุจ ุฃู ุชููู ุจูุงูุงุช ุงูุงุชุตุงู ุตุญูุญุฉ (API URL, credentials)
- ูุฌุจ ุฃู ูููู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช ูุชุงุญุงู

## ๐ ุงููุฑุงูุจุฉ ูุงูุชุชุจุน

### ูู Console ุงููุชุตูุญ:

```javascript
// ุนูุฏ ุจุฏุก ุงูุชุทุจูู
[GlobalApiSync] Initializing global API sync service...
[ApiSyncService] ๐ Initializing global sync service...

// ุนูุฏ ุชูุนูู ุงููุฒุงููุฉ
[ApiSyncService] โ Global sync ENABLED - Running in background
[ApiSyncService] ๐ Starting continuous sync - Every 30 seconds

// ุฃุซูุงุก ุงููุฒุงููุฉ
[ApiSyncService] โฐ Scheduled sync triggered
[ApiSyncService] ๐ Starting sync for 2 active connection(s)
[ApiSyncService] โ Successfully synced: AK-Booking IQD
[ApiSyncService] โ Successfully synced: AK-Booking USD
[ApiSyncService] ๐ฏ Sync completed - Success: 2, Failed: 0

// ุนูุฏ ุฅููุงู ุงููุฒุงููุฉ
[ApiSyncService] ๐ Stopping continuous sync
```

### ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู:

#### ูุคุดุฑุงุช ุงูุญุงูุฉ:
- ๐ข **ูุดุทุฉ** - ุงููุฒุงููุฉ ุชุนูู ูู ุงูุฎูููุฉ
- โซ **ูุชูููุฉ** - ุงููุฒุงููุฉ ุบูุฑ ูุดุทุฉ

#### ุงููุนูููุงุช ุงููุนุฑูุถุฉ:
- **ุงูุชูุฑุงุฑ**: ูู ูู ุซุงููุฉ ุชุชู ุงููุฒุงููุฉ
- **ุขุฎุฑ ุชุญุฏูุซ**: ููุช ุขุฎุฑ ูุฒุงููุฉ ูุงุฌุญุฉ
- **ุฌุงุฑู ุงูุชูููุฐ**: ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุฒุงููุฉ/ุงูุฅุฌูุงูู
- **ุงูุงุชุตุงู ุงูุญุงูู**: ุงุณู ุงูุงุชุตุงู ุงูุฐู ูุชู ูุฒุงููุชู ุงูุขู

## ๐ง ุงูุชูููู ุงููุชูุฏู

### ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช Firestore:

```
system_config/
  โโ> global_sync_config
       โโ> syncEnabled: boolean
       โโ> syncFrequency: number (ุจุงูุซูุงูู)
       โโ> lastUpdated: timestamp
       โโ> updatedBy: string
```

### ุงูุชุนุฏูู ุงููุจุงุดุฑ:
ููููู ุชุนุฏูู ุงูุฅุนุฏุงุฏุงุช ูุจุงุดุฑุฉ ูู Firestore Console ูุณูุชู ุชุทุจูู ุงูุชุบููุฑุงุช ููุฑุงู ุนูู ุฌููุน ุงููุณุชุฎุฏููู.

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฃุฏุงุก:**
   - ูุง ุชูู ุจุชุนููู ูุชุฑุฉ ูุฒุงููุฉ ูุตูุฑุฉ ุฌุฏุงู (ุฃูู ูู 10 ุซูุงูู)
   - ูู ูุฒุงููุฉ ุชุณุชููู ููุงุฑุฏ API

2. **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:**
   - ุฅุฐุง ูุดูุช ูุฒุงููุฉ ูุนููุฉุ ุณูุชู ุชุฎุทููุง ูุงูุงูุชูุงู ููุชุงููุฉ
   - ุงูุฃุฎุทุงุก ูุง ุชููู ุงููุฒุงููุฉ ุงูุนุงูููุฉ
   - ูุชู ุญูุธ ุฑุณุงุฆู ุงูุฃุฎุทุงุก ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

3. **ุงูุงุชุตุงูุงุช ุงููุดุทุฉ ููุท:**
   - ูุชู ูุฒุงููุฉ ุงูุงุชุตุงูุงุช ุงูุชู ููุง `isActive: true` ููุท
   - ููููู ุชุนุทูู ุงุชุตุงู ุฏูู ุญุฐูู

4. **ุงูุชูุธูู ุงูุชููุงุฆู:**
   - ุนูุฏ ุฅุบูุงู ุงูุชุทุจููุ ูุชู ุฅููุงู ุงููุฒุงููุฉ ุชููุงุฆูุงู
   - ุนูุฏ ุฅุนุงุฏุฉ ูุชุญ ุงูุชุทุจููุ ุชุจุฏุฃ ุงููุฒุงููุฉ ูู ุฌุฏูุฏ ุญุณุจ ุงูุฅุนุฏุงุฏุงุช ุงููุญููุธุฉ

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงููุฒุงููุฉ ูุง ุชุนูู

**ุงูุญููู:**
1. ุชุญูู ูู ุชูุนูู ุงููุฒุงููุฉ ุงูุนุงูููุฉ
2. ุชุฃูุฏ ูู ูุฌูุฏ ุงุชุตุงูุงุช ูุดุทุฉ
3. ุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุงุชุตุงู (API URL, credentials)
4. ุงูุชุญ Console ูุชุญูู ูู ุฑุณุงุฆู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงููุฒุงููุฉ ุจุทูุฆุฉ

**ุงูุญููู:**
1. ููู ูุชุฑุฉ ุงููุฒุงููุฉ
2. ุชุญูู ูู ุณุฑุนุฉ ุงูุฅูุชุฑูุช
3. ุชุฃูุฏ ูู ุฃู API ุงูุฎุงุฑุฌู ูุณุชุฌูุจ ุจุณุฑุนุฉ

### ุงููุดููุฉ: ุจุนุถ ุงูุงุชุตุงูุงุช ุชูุดู

**ุงูุญููู:**
1. ุงูุชุญ ุชูุงุตูู ุงูุงุชุตุงู ูุดุงูุฏ ุฑุณุงูุฉ ุงูุฎุทุฃ
2. ุงุฎุชุจุฑ ุงูุงุชุตุงู ูุฏููุงู
3. ุชุฃูุฏ ูู ุตุญุฉ ุงูุนููุฉ ุงููุฎุชุงุฑุฉ
4. ุชุญูู ูู ุฃู API ูุง ุฒุงู ูุนูู

## ๐ ุฃูุซูุฉ ุนูู ุงูุงุณุชุฎุฏุงู

### ูุซุงู 1: ุฅุนุฏุงุฏ ูุฒุงููุฉ ูู ุฏูููุฉ

```typescript
// ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู
1. ุงุฐูุจ ุฅูู ุตูุญุฉ "ุฑุจุท API"
2. ูุนูู ุงููุฒุงููุฉ ุงูุนุงูููุฉ
3. ุฃุฏุฎู "60" ูู ุญูู ุงูุชูุฑุงุฑ
4. ุงุถุบุท Enter ุฃู ุงูุชูู ูุญูู ุขุฎุฑ
```

### ูุซุงู 2: ุฅุถุงูุฉ listener ูููุฒุงููุฉ

```typescript
import { apiSyncService } from './lib/services/apiSyncService';

// ูู ูููู React
useEffect(() => {
  const handleSyncStatus = (status) => {
    console.log('Sync status:', status);
    if (status.isRunning) {
      console.log(`Syncing ${status.syncedCount}/${status.totalConnections}`);
    }
  };

  apiSyncService.addListener(handleSyncStatus);

  return () => {
    apiSyncService.removeListener(handleSyncStatus);
  };
}, []);
```

### ูุซุงู 3: ูุฒุงููุฉ ููุฑูุฉ ุจุฑูุฌูุงู

```typescript
import { apiSyncService } from './lib/services/apiSyncService';

// ุชุดุบูู ูุฒุงููุฉ ููุฑูุฉ
await apiSyncService.syncNow();
```

## ๐ ุงูุฎูุงุตุฉ

ูุธุงู ุงููุฒุงููุฉ ุงูุนุงูููุฉ ูู ุงูุฎูููุฉ ูููุฑ:
- โ ุชุญุฏูุซ ุชููุงุฆู ููุฃุฑุตุฏุฉ
- โ ุนูู ูุณุชูุฑ ูู ุงูุฎูููุฉ
- โ ุชุญูู ูุงูู ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู
- โ ูุชุงุจุนุฉ ููุฑูุฉ ููุญุงูุฉ
- โ ูุนุงูุฌุฉ ุฐููุฉ ููุฃุฎุทุงุก
- โ ุฃุฏุงุก ูุญุณูู

ูุน ูุฐุง ุงููุธุงูุ ูู ุชุญุชุงุฌ ุฅูู ุชุญุฏูุซ ุงูุฃุฑุตุฏุฉ ูุฏููุงู ุจุนุฏ ุงูุขู! ๐
